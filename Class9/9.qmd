---
title: "Class 09: Structural Bioinformatics"
author: "Courtney Anderson (PID:A69038035)"
format: pdf
---
## The PDB Database

The main repository for biomolecular sturcture data is in the Protein Data Bank (PDB): https://www.rcsb.org 

Lets have a quick look at the composition of this database: 

>Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

This is annoying, lets try a different import function from the **readr** package. 
```{r}
library(readr)

stats <- read_csv("Data Export Summary.csv")
stats
```
```{r}
round(sum(stats$`X-ray`)/sum(stats$Total)*100,3)
```
```{r}
round(sum(stats$EM)/sum(stats$Total)*100,3)
```

>Q2: What proportion of structures in the PDB are protein? 

```{r}
total <- sum(stats$Total)
210203/total
```


```{r}
library (ggplot2)

y<- ggplot(stats, aes(reorder(`Molecular Type`, -Total), `Total`))+
  geom_col()+
  labs(title="PDB Database Composition Oct 2025", x="",y= "Number of structures")+ 
theme_minimal()

y + theme(
  axis.text.x = element_text(angle = 45, hjust = 1)
)

```


>Q3.2: Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?

>There are 150 structures.

## Visualising structure data

The Mol* viewer is imbedded in many bioinformatics websites. the home page is : https://www.molstar.org

I can insert any figure or file image using the markdown format.

![The HIV-Pr dimer with bound inhibitor](1HSG.png)

![](1HSG copy_2.png)

##Bio3D package for structural bioinformatics 

We can used the bio3d package to read and analyze biomolecular data in R: 
```{r}
library(bio3d)

hiv<- read.pdb("1hsg")
hiv
```

```{r}
head(hiv$atom)
```
```{r}
pdbseq(hiv)
```

Lets trim to chain A and get it's seqeunce: 
```{r}
chainA <- trim.pdb(hiv, chain="A")
chainA.seq <-pdbseq(chainA)
```
Let's blast 
```{r blast_hiv, cache=TRUE}
blast<- blast.pdb(chainA.seq)
```
```{r}
head(blast)
```

Plot a quick overview of blast results 
```{r}
hits<- plot(blast)
```

```{r}
hits$pdb.id
```

## Prediction of functional motions 

We can run a Normal Mode Analysis (NMA) to predit large scale motions/flexibility/ dynamics of any biomolecule that we can read into R. 

Lets look at ADK 
```{r}
adk <- read.pdb("1AKE")

adk_A<- trim.pdb (adk, chain="A")
adk_A
```

```{r}
m<- nma(adk_A)
plot(m)
```
Let's write out a trajectory of predicted motion 
```{r}
mktrj(m, file="adk_nma.pdb")
```

## Play with 3D viewing in R

We can use the new **bio3dview** package, which is not yet on CRAN, to render interactive 3D views in R and html quarto output reports.

To install from GitHub we can use the **pak** package 
```{r}
library(pak)

#view.pdb(adk)
```
## NOVEMBER 5th CLASS
```{r}
library(bio3d)

id <- "1ake_A"

aa <- get.seq(id)
aa
```

```{r, cache=TRUE}
blast<-blast.pdb(aa)
hits<- plot(blast)
```
```{r}
hits$pdb.id
```
Download all these "hits" that are similar to our starting id sequence 
```{r}
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
```
```{r}
pdbs <- pdbaln(files, fit=TRUE,, exefile="msa")
```

```{r}
pc.xray<-pca(pdbs)
plot(pc.xray)
```
```{r}
plot(pc.xray, 1:2)
```
```{r}
mktrj(pc.xray, file="pc_results.pdb")
```

```{r}
library(bio3dview)
view.pca(pc.xray)
```

